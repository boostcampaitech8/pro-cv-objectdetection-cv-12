2025-12-07 06:00:56,213 INFO    MainThread:1278524 [wandb_setup.py:_flush():80] Current SDK version is 0.23.0
2025-12-07 06:00:56,213 INFO    MainThread:1278524 [wandb_setup.py:_flush():80] Configure stats pid to 1278524
2025-12-07 06:00:56,214 INFO    MainThread:1278524 [wandb_setup.py:_flush():80] Loading settings from /data/ephemeral/home/.config/wandb/settings
2025-12-07 06:00:56,214 INFO    MainThread:1278524 [wandb_setup.py:_flush():80] Loading settings from /data/ephemeral/home/pybum_bumjin/DEIMv2/wandb/settings
2025-12-07 06:00:56,214 INFO    MainThread:1278524 [wandb_setup.py:_flush():80] Loading settings from environment variables
2025-12-07 06:00:56,214 INFO    MainThread:1278524 [wandb_init.py:setup_run_log_directory():713] Logging user logs to /data/ephemeral/home/pybum_bumjin/DEIMv2/wandb/run-20251207_060056-cs9gqd8m/logs/debug.log
2025-12-07 06:00:56,214 INFO    MainThread:1278524 [wandb_init.py:setup_run_log_directory():714] Logging internal logs to /data/ephemeral/home/pybum_bumjin/DEIMv2/wandb/run-20251207_060056-cs9gqd8m/logs/debug-internal.log
2025-12-07 06:00:56,214 INFO    MainThread:1278524 [wandb_init.py:init():840] calling init triggers
2025-12-07 06:00:56,214 INFO    MainThread:1278524 [wandb_init.py:init():845] wandb.init called with sweep_config: {}
config: {'task': 'detection', 'evaluator': {'type': 'CocoEvaluator', 'iou_types': ['bbox']}, 'num_classes': 10, 'remap_mscoco_category': False, 'train_dataloader': {'type': 'DataLoader', 'dataset': {'type': 'CocoDetection', 'img_folder': '../../dataset_tagging/train', 'ann_file': '../../dataset_tagging/new_train_split.json', 'return_masks': False, 'transforms': {'type': 'Compose', 'ops': [{'type': 'Mosaic', 'output_size': 320, 'rotation_range': 10, 'translation_range': [0.1, 0.1], 'scaling_range': [0.5, 1.5], 'probability': 1.0, 'fill_value': 0, 'use_cache': True, 'max_cached_images': 50, 'random_pop': True}, {'type': 'RandomPhotometricDistort', 'p': 0.5}, {'type': 'RandomZoomOut', 'fill': 0}, {'type': 'RandomIoUCrop', 'p': 0.8}, {'type': 'SanitizeBoundingBoxes', 'min_size': 1}, {'type': 'RandomHorizontalFlip'}, {'type': 'Resize', 'size': [1024, 1024]}, {'type': 'SanitizeBoundingBoxes', 'min_size': 1}, {'type': 'ConvertPILImage', 'dtype': 'float32', 'scale': True}, {'type': 'Normalize', 'mean': [0.485, 0.456, 0.406], 'std': [0.229, 0.224, 0.225]}, {'type': 'ConvertBoxes', 'fmt': 'cxcywh', 'normalize': True}], 'policy': {'name': 'stop_epoch', 'epoch': [5, 10, 15], 'ops': ['Mosaic', 'RandomPhotometricDistort', 'RandomZoomOut', 'RandomIoUCrop']}, 'mosaic_prob': 0.5}}, 'shuffle': True, 'num_workers': 4, 'drop_last': True, 'collate_fn': {'type': 'BatchImageCollateFunction', 'base_size': 1024, 'base_size_repeat': 3, 'stop_epoch': 50, 'mixup_prob': 0.5, 'mixup_epochs': [4, 29], 'copyblend_prob': 0.5, 'copyblend_epochs': [4, 50], 'area_threshold': 100, 'num_objects': 3, 'with_expand': True, 'expand_ratios': [0.1, 0.25], 'ema_restart_decay': 0.9999}, 'total_batch_size': 8}, 'val_dataloader': {'type': 'DataLoader', 'dataset': {'type': 'CocoDetection', 'img_folder': '../../dataset_tagging/valid', 'ann_file': '../../dataset_tagging/new_val_split.json', 'return_masks': False, 'transforms': {'type': 'Compose', 'ops': [{'type': 'Resize', 'size': [1024, 1024]}, {'type': 'ConvertPILImage', 'dtype': 'float32', 'scale': True}, {'type': 'Normalize', 'mean': [0.485, 0.456, 0.406], 'std': [0.229, 0.224, 0.225]}]}}, 'shuffle': False, 'num_workers': 4, 'drop_last': False, 'collate_fn': {'type': 'BatchImageCollateFunction'}, 'total_batch_size': 16}, 'print_freq': 500, 'output_dir': './outputs/deimv2_dinov3_x_coco', 'checkpoint_freq': 5, 'sync_bn': True, 'find_unused_parameters': True, 'use_amp': True, 'scaler': {'type': 'GradScaler', 'enabled': True}, 'use_ema': True, 'ema': {'type': 'ModelEMA', 'decay': 0.9999, 'warmups': 1000, 'start': 0}, 'epoches': 32, 'clip_max_norm': 0.1, 'optimizer': {'type': 'AdamW', 'params': [{'params': '^(?=.*.dinov3)(?!.*(?:norm|bn|bias)).*$', 'lr': 1e-05}, {'params': '^(?=.*.dinov3)(?=.*(?:norm|bn|bias)).*$', 'lr': 1e-05, 'weight_decay': 0.0}, {'params': '^(?=.*(?:sta|encoder|decoder))(?=.*(?:norm|bn|bias)).*$', 'weight_decay': 0.0}], 'lr': 0.0005, 'betas': [0.9, 0.999], 'weight_decay': 0.000125}, 'lr_scheduler': {'type': 'MultiStepLR', 'milestones': [500], 'gamma': 0.1}, 'lr_warmup_scheduler': {'type': 'LinearWarmup', 'warmup_duration': 500}, 'model': 'DEIM', 'criterion': 'DEIMCriterion', 'postprocessor': 'PostProcessor', 'use_focal_loss': True, 'eval_spatial_size': [1024, 1024], 'DEIM': {'backbone': 'DINOv3STAs', 'encoder': 'HybridEncoder', 'decoder': 'DEIMTransformer'}, 'HGNetv2': {'name': 'B4', 'return_idx': [1, 2, 3], 'freeze_at': -1, 'freeze_stem_only': True, 'freeze_norm': False, 'pretrained': False, 'local_model_dir': './weight/hgnetv2/'}, 'HybridEncoder': {'in_channels': [256, 256, 256], 'feat_strides': [8, 16, 32], 'hidden_dim': 256, 'use_encoder_idx': [2], 'num_encoder_layers': 1, 'nhead': 8, 'dim_feedforward': 1024, 'dropout': 0.0, 'enc_act': 'gelu', 'expansion': 1.25, 'depth_mult': 1.37, 'act': 'silu', 'version': 'deim', 'csp_type': 'csp2', 'fuse_op': 'sum'}, 'DEIMTransformer': {'feat_channels': [256, 256, 256], 'feat_strides': [8, 16, 32], 'hidden_dim': 256, 'num_levels': 3, 'num_layers': 6, 'eval_idx': -1, 'num_queries': 300, 'num_denoising': 100, 'label_noise_ratio': 0.5, 'box_noise_scale': 1.0, 'reg_max': 32, 'reg_scale': 4, 'layer_scale': 1, 'num_points': [3, 6, 3], 'cross_attn_method': 'default', 'query_select_method': 'default', 'activation': 'silu', 'mlp_act': 'silu', 'dim_feedforward': 2048}, 'PostProcessor': {'num_top_queries': 300}, 'lrsheduler': 'flatcosine', 'lr_gamma': 0.5, 'warmup_iter': 2000, 'flat_epoch': 14, 'no_aug_epoch': 12, 'DEIMCriterion': {'weight_dict': {'loss_mal': 1, 'loss_bbox': 5, 'loss_giou': 2, 'loss_fgl': 0.15, 'loss_ddf': 1.5}, 'losses': ['mal', 'boxes', 'local'], 'gamma': 1.5, 'alpha': 0.75, 'reg_max': 32, 'matcher': {'type': 'HungarianMatcher', 'weight_dict': {'cost_class': 2, 'cost_bbox': 5, 'cost_giou': 2}, 'alpha': 0.25, 'gamma': 2.0, 'change_matcher': True, 'iou_order_alpha': 4.0, 'matcher_change_epoch': 45}}, '__include__': ['../dataset/custom_detection.yml', '../runtime.yml', '../base/dataloader.yml', '../base/optimizer.yml', '../base/deimv2.yml'], 'DINOv3STAs': {'name': 'dinov3_vits16plus', 'weights_path': './ckpts/dinov3_vits16plus_pretrain_lvd1689m-4057cbaa.pth', 'interaction_indexes': [5, 8, 11], 'finetune': True, 'conv_inplane': 64, 'hidden_dim': 256}, 'config': 'configs/deimv2/deimv2_dinov3_x_coco.yml', 'tuning': './weight/deimv2_dinov3_x_coco.pth', 'seed': 42, 'test_only': False, 'print_method': 'builtin', 'print_rank': 0, '_wandb': {}}
2025-12-07 06:00:56,214 INFO    MainThread:1278524 [wandb_init.py:init():888] starting backend
2025-12-07 06:00:56,479 INFO    MainThread:1278524 [wandb_init.py:init():891] sending inform_init request
2025-12-07 06:00:56,482 INFO    MainThread:1278524 [wandb_init.py:init():899] backend started and connected
2025-12-07 06:00:56,485 INFO    MainThread:1278524 [wandb_init.py:init():969] updated telemetry
2025-12-07 06:00:56,490 INFO    MainThread:1278524 [wandb_init.py:init():993] communicating run to backend with 90.0 second timeout
2025-12-07 06:00:57,332 INFO    MainThread:1278524 [wandb_init.py:init():1040] starting run threads in backend
2025-12-07 06:00:57,548 INFO    MainThread:1278524 [wandb_run.py:_console_start():2504] atexit reg
2025-12-07 06:00:57,549 INFO    MainThread:1278524 [wandb_run.py:_redirect():2352] redirect: wrap_raw
2025-12-07 06:00:57,549 INFO    MainThread:1278524 [wandb_run.py:_redirect():2421] Wrapping output streams.
2025-12-07 06:00:57,549 INFO    MainThread:1278524 [wandb_run.py:_redirect():2444] Redirects installed.
2025-12-07 06:00:57,552 INFO    MainThread:1278524 [wandb_init.py:init():1080] run started, returning control to user process
2025-12-07 06:00:58,682 INFO    wandb-AsyncioManager-main:1278524 [service_client.py:_forward_responses():80] Reached EOF.
2025-12-07 06:00:58,682 INFO    wandb-AsyncioManager-main:1278524 [mailbox.py:close():137] Closing mailbox, abandoning 1 handles.
